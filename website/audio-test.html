<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Test - Pranayam Helper</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #0f0f1e;
            color: #fff;
        }
        h1 {
            color: #667eea;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #1a1a2e;
            border-radius: 12px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #5568d3;
        }
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 6px;
        }
        .success {
            background: #43e97b33;
            color: #43e97b;
        }
        .error {
            background: #ff6b6b33;
            color: #ff6b6b;
        }
        .info {
            background: #4facfe33;
            color: #4facfe;
        }
    </style>
</head>
<body>
    <h1>ðŸŽµ Audio Files Test</h1>
    <p>Use this page to test if your audio files are properly placed and working.</p>

    <div class="test-section">
        <h2>1. Test inhale.mp3</h2>
        <button onclick="testAudio('inhale.mp3', 'inhaleStatus')">Play Inhale</button>
        <button onclick="testStretchedAudio('inhale.mp3', 10, 'inhaleStatus')">Play Stretched (10s)</button>
        <div id="inhaleStatus" class="status info">Click button to test</div>
    </div>

    <div class="test-section">
        <h2>2. Test exhale.mp3</h2>
        <button onclick="testAudio('exhale.mp3', 'exhaleStatus')">Play Exhale</button>
        <button onclick="testStretchedAudio('exhale.mp3', 10, 'exhaleStatus')">Play Stretched (10s)</button>
        <div id="exhaleStatus" class="status info">Click button to test</div>
    </div>

    <div class="test-section">
        <h2>3. Test ting.mp3</h2>
        <button onclick="testAudio('ting.mp3', 'tingStatus')">Play Ting</button>
        <div id="tingStatus" class="status info">Click button to test</div>
    </div>

    <div class="test-section">
        <h2>4. Test Complete Sequence</h2>
        <p>This simulates: Inhale (5s) â†’ Ting â†’ Hold (3s) â†’ Ting â†’ Exhale (6s) â†’ Ting</p>
        <button onclick="testSequence()">Test Sequence</button>
        <div id="sequenceStatus" class="status info">Click button to test</div>
    </div>

    <script>
        let currentAudio = null;

        function testAudio(filename, statusId) {
            const status = document.getElementById(statusId);
            const audio = new Audio(filename);
            
            status.textContent = `Loading ${filename}...`;
            status.className = 'status info';
            
            audio.addEventListener('loadedmetadata', () => {
                status.textContent = `âœ“ File loaded! Duration: ${audio.duration.toFixed(2)}s. Playing...`;
                status.className = 'status success';
            });
            
            audio.addEventListener('error', (e) => {
                status.textContent = `âœ— Error: Cannot load ${filename}. Make sure the file exists in the same directory.`;
                status.className = 'status error';
            });
            
            audio.addEventListener('ended', () => {
                status.textContent = `âœ“ Finished playing ${filename}`;
                status.className = 'status success';
            });
            
            if (currentAudio) {
                currentAudio.pause();
            }
            currentAudio = audio;
            audio.play().catch(e => {
                status.textContent = `âœ— Playback error: ${e.message}`;
                status.className = 'status error';
            });
        }

        function testStretchedAudio(filename, targetDuration, statusId) {
            const status = document.getElementById(statusId);
            const audio = new Audio(filename);
            
            status.textContent = `Loading ${filename}...`;
            status.className = 'status info';
            
            audio.addEventListener('loadedmetadata', () => {
                const originalDuration = audio.duration;
                const playbackRate = originalDuration / targetDuration;
                audio.playbackRate = playbackRate;
                
                status.textContent = `âœ“ Stretching from ${originalDuration.toFixed(2)}s to ${targetDuration}s (rate: ${playbackRate.toFixed(2)}x). Playing...`;
                status.className = 'status success';
            });
            
            audio.addEventListener('error', (e) => {
                status.textContent = `âœ— Error: Cannot load ${filename}`;
                status.className = 'status error';
            });
            
            audio.addEventListener('ended', () => {
                status.textContent = `âœ“ Finished playing stretched ${filename}`;
                status.className = 'status success';
            });
            
            if (currentAudio) {
                currentAudio.pause();
            }
            currentAudio = audio;
            audio.play().catch(e => {
                status.textContent = `âœ— Playback error: ${e.message}`;
                status.className = 'status error';
            });
        }

        async function testSequence() {
            const status = document.getElementById('sequenceStatus');
            
            try {
                status.textContent = 'Playing inhale (5s)...';
                status.className = 'status info';
                await playStretchedAudio('inhale.mp3', 5);
                
                status.textContent = 'Playing ting after inhale...';
                await playAudio('ting.mp3');
                
                status.textContent = 'Hold phase (3s) - silence...';
                await sleep(3000);
                
                status.textContent = 'Playing ting after hold...';
                await playAudio('ting.mp3');
                
                status.textContent = 'Playing exhale (6s)...';
                await playStretchedAudio('exhale.mp3', 6);
                
                status.textContent = 'Playing ting after exhale...';
                await playAudio('ting.mp3');
                
                status.textContent = 'âœ“ Sequence complete!';
                status.className = 'status success';
            } catch (error) {
                status.textContent = `âœ— Error: ${error.message}`;
                status.className = 'status error';
            }
        }

        function playAudio(filename) {
            return new Promise((resolve, reject) => {
                const audio = new Audio(filename);
                audio.addEventListener('ended', resolve);
                audio.addEventListener('error', () => reject(new Error(`Cannot load ${filename}`)));
                audio.play().catch(reject);
                currentAudio = audio;
            });
        }

        function playStretchedAudio(filename, targetDuration) {
            return new Promise((resolve, reject) => {
                const audio = new Audio(filename);
                
                audio.addEventListener('loadedmetadata', () => {
                    const originalDuration = audio.duration;
                    audio.playbackRate = originalDuration / targetDuration;
                    audio.play().catch(reject);
                });
                
                audio.addEventListener('ended', resolve);
                audio.addEventListener('error', () => reject(new Error(`Cannot load ${filename}`)));
                currentAudio = audio;
            });
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
